---
layout: post
title: CVE-2022-22265 Samsung npu driver
date: 2024-08-12
categories: ["CVE", "Exploit", "Linux", "Kernel", "Android"]
thumbnail: "assets/images/thumb_4.png"
---

## Warning

Getting context from npu driver..

![policy_npu](/assets/images/policy_npu.png)

The NPU driver in this version is restricted from shell. If you want to use this exploit, you'll need to adapt it to an unstrusted app. 

![policy_shell](/assets/images/policy_shell.png)
![policy_unstrusted_app](/assets/images/policy_untrusted_app.png)

Also, this NPU driver version had the bug patched, so I modified the communication with the firmware in **npu-interface.c** (because the analysis it was unnecessary, each firmware includes its own extra check code, I don't want to do hard work for nothing, thanks). If you want help with reversing the firmware you could look at [this](https://blog.impalabs.com/2103_reversing-samsung-npu.html) and [this](https://blog.impalabs.com/2110_exploiting-samsung-npu.html). You'll need to adapt it as well.

![npu_patched](/assets/images/npu_patched.png)

## Introduction


##### Demo

![thumb](/assets/images/thumb_4.png)
![reverse shell](/assets/images/reverse_shell.png)

##### Full exploit

[https://gist.github.com/soez/66eabe37a8dec0937cba8e0cb1ab7ebb](https://gist.github.com/soez/66eabe37a8dec0937cba8e0cb1ab7ebb)

## References

[https://blog.impalabs.com/2103_reversing-samsung-npu.html](https://blog.impalabs.com/2103_reversing-samsung-npu.html)
[https://blog.impalabs.com/2110_exploiting-samsung-npu.html](https://blog.impalabs.com/2110_exploiting-samsung-npu.html)
